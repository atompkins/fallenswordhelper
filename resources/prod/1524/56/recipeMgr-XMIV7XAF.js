import{a as M}from"./chunk-AYG6WLDR.js";import{c as O}from"./chunk-4SKU2ULK.js";import{a as Q}from"./chunk-MWBJMPWS.js";import{a as g}from"./chunk-5FYKNJHI.js";import{a as U}from"./chunk-BOYBHYC4.js";import"./chunk-POGZRGFB.js";import{a as S}from"./chunk-5JNABZ7V.js";import{a as w,b as B}from"./chunk-6AYIUHMJ.js";import"./chunk-2ON4JKLP.js";import{a as D}from"./chunk-YY6M7RTY.js";import"./chunk-GCBZB6Q7.js";import{a as H}from"./chunk-EVK5QPY3.js";import{a as b}from"./chunk-5QL3EWJR.js";import"./chunk-7ET2CA5W.js";import{b as R}from"./chunk-GD4HMFZG.js";import{a as p}from"./chunk-BUIH7NDX.js";import"./chunk-2FGL6JOK.js";import{a as c}from"./chunk-JZUIGPQK.js";import"./chunk-E7LHQKU5.js";import"./chunk-ACUTGVKN.js";import"./chunk-KETFGQQM.js";import"./chunk-7PZO5YGA.js";import"./chunk-IXP25ZKY.js";import{a as j}from"./chunk-6RYYSQKY.js";import{a as C}from"./chunk-OMKWEQGC.js";import"./chunk-NRM2IEBO.js";import{a as l}from"./chunk-KHAKP3NJ.js";import{a as _}from"./chunk-LJXKCPK7.js";import"./chunk-CDQY3GPS.js";import{a as u}from"./chunk-E66CENYR.js";import"./chunk-7XYKFTOV.js";import{a as y}from"./chunk-6UGBR7LD.js";import{a as k}from"./chunk-BRACYM44.js";import"./chunk-HSGQLATB.js";import"./chunk-JYV3Y4PK.js";import{a as s}from"./chunk-VYOJRJTP.js";import"./chunk-IZEIZGGY.js";import"./chunk-H4RRBTG7.js";import"./chunk-D4RSYPIY.js";import"./chunk-SQ3ABL2K.js";import{a as d}from"./chunk-S2PPJ2GD.js";import{b as F}from"./chunk-MIGTOE2L.js";import"./chunk-UYUWQQUH.js";import"./chunk-FMIILUE6.js";import"./chunk-XSTNX5IW.js";import"./chunk-UVCMQZY6.js";import{a as n}from"./chunk-NGIDL4MJ.js";var I,q=[];function V(t){return`<div class="rmItem"><img class="tip-dynamic" data-tipped="fetchitem.php?item_id=${t.id}&inv_id=-1&t=2&p=${I}&vcode=${t.verify}" src="${t.img}" height="20px" width="20px"><p>${t.amountPresent}/${t.amountNeeded}</p></div>`}function z(t){return t.items?t.items.map(V).join(""):""}function G(t){return`<div class="rmItem"><img class="tip-dynamic" data-tipped="fetchitem.php?item_id=${t.id}&inv_id=-1&t=2&p=${I}&vcode=${t.verify}" src="${t.img}" height="20px" width="20px"><p>${t.amountPresent}/${t.amountNeeded}</p></div>`}function J(t){return t.components?t.components.map(G).join(""):""}function K(t){return t.target?` <img class="tip-dynamic" data-tipped="fetchitem.php?item_id=${t.target.id}&inv_id=-1&t=2&p=${I}&vcode=${t.target.verify}" src="${t.target.img}" height="30px" width="30px"><br/>`:""}function W(t){return!q.includes(t.name)}function X(t){return`<tr class="rmTr"><td class="rmTd"><a href="${t.link}"><img src="${t.img}" height="30px" width="30px"></a></td><td class="rmTd"><a href="${t.link}">${t.name}</a></td><td class="rmTd">${z(t)}</td><td class="rmTd">${J(t)}</td><td class="rmTd">${K(t)}</td></tr>`}function Y(t,e){I=S();let r='<table width="100%"><tr class="rmTh"><th>Recipe</th><th><span id="sortName" class="fshLink" sortkey="name">Name</span></th><th>Items</th><th>Components</th><th>Target</th></tr>';r+=e.recipe.filter(W).map(X).join(""),r+="</table>",y(r,t),B("fsh_recipeBook",e)}function h(t,e){e&&(F("hideRecipes")&&(q=U("hideRecipeNames")),Y(t,e))}function x(t){let e=s("pCC",t).children[0].rows[4].cells[0].children[0];return p("img",e)}var Z=/fetchitem.php\?item_id=(\d+)&inv_id=-1&t=2&p=(\d+)&vcode=([a-z0-9]+)/i;function tt(t){return p("td",s("pCC",t))}function et(t,e){let r=e.getAttribute("background");return r&&r.includes(t)}function rt(t){return t.dataset.tipped.match(Z)}function ot(t,e){return{img:t.getAttribute("src"),id:e[1],verify:e[3]}}function nt(t,e){if(e){let r=d(e).split("/");t.amountPresent=parseInt(r[0],10),t.amountNeeded=parseInt(r[1],10)}}function mt(t){let e=t.children[0].children[0],r=rt(e),o=ot(e,r);return nt(o,t.parentNode.nextElementSibling),o}function A(t,e){return t.filter(n(et,e)).map(mt)}function P(t,e,r,o){let i=l(o);c(t,`Parsing blueprint ${r.name}...<br>`);let f=tt(i);r.items=A(f,"/inventory/2x3."),r.components=A(f,"/inventory/1x1mini."),[r.target]=A(f,"/hellforge/2x3."),e.recipe.push(r)}function it(t){let r=s("pCC",t).children[0].rows[6].cells[0].children[0];return p("a",r)}function at(t){return{img:t.parentNode.previousElementSibling.children[0].getAttribute("src"),link:t.href,name:d(t),id:b(t.search,"recipe_id")}}function st(t,e,r){c(t,`Found blueprint "${d(r)}".<br>`);let o=at(r);return u(r.href).then(n(P,t,e,o))}function v(t,e,r){let o=l(r),i=it(o).map(n(st,t,e));return g(i)}function ct(t){return/\/folder_on\./.test(t.getAttribute("src"))}function pt(t){return x(t).find(ct).parentNode.href}function lt(t,e){return e!==0}function dt(t){return t.value}function ft(t){return p("option",H("customselect",s("pCC",t))[0]).filter(lt).map(dt)}function ut(t,e,r){return u(`${t}&page=${r}`).then(e)}function gt(t,e,r){return ft(t).map(n(ut,e,r))}function T(t,e,r){let o=l(r),i=pt(o),f=n(v,t,e),$=gt(o,i,f);return $.push(f(r)),g($)}function ht(t){return b(t.parentNode.search,"folder_id")!=="-1"}function yt(t,e){let r=d(e.parentNode.nextElementSibling.nextElementSibling.firstChild),o=/quest/i.test(r);return o&&c(t,`Skipping folder "${r}"  as it has the word "quest" in folder name.<br>`),!o}function xt(t,e){return u(e.parentNode.href).then(t)}function bt(t,e,r){let o=l(e);return x(o).filter(ht).filter(n(yt,t)).map(n(xt,r))}function N(t,e,r){let o=n(T,t,e),i=bt(t,r,o);return i.push(o(r)),g(i)}var m,a;function Bt(){c(a,"Finished parsing ... formatting ..."),B("fsh_recipeBook",m),h(a,m)}function E(){m={},m.recipe=[],y("<br>Parsing inventing screen ...<br>",a),_({cmd:"inventing"}).then(n(N,a,m)).then(Bt)}function L(t,e){m=e,y('<table class="fshInvFilter"><thead><tr><th width="90%"><b>&nbsp;Recipe Manager</b></th><th width="10%" class="fshBtnBox">[<span id="rfsh" class="fshLink">Refresh</span>]</th></tr></thead></table>',t),a=C(),j(t,a),m?h(a,m):E()}function It(t){M(t.target),m.recipe.sort(O),h(a,m)}function At(t){t.target.id==="rfsh"&&E(),t.target.id==="sortName"&&It(t)}function Pt(t){if(D())return;let e=t||R;w("fsh_recipeBook").then(n(L,e)),k(e,At),Q("ui-dialog-titlebar-close").forEach(r=>r.blur())}export{Pt as default};
//# sourceMappingURL=recipeMgr-XMIV7XAF.js.map
