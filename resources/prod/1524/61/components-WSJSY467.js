import{a as We,b as Fe,c as Ge}from"./chunk-4XYU3JZK.js";import"./chunk-WUZMEUSW.js";import{a as ae}from"./chunk-KF2SJX32.js";import{a as Ue}from"./chunk-HFYMBZJ6.js";import{a as H}from"./chunk-SSCBWJQF.js";import"./chunk-UYCSF7TZ.js";import"./chunk-C5ZRYS4R.js";import{a as J}from"./chunk-AWR2RX47.js";import{A as le,C as ee,G as ce,H as ie,J as N,K as R,L as h,M as v,O as Ve,P as He,Q as B,R as I,S as Q,T as Y,U as Z,a as A,d as O,e as me,g as Ne,h as ne,m as X,o as u,p as y,q as D,r as Re,s as g,t as E,u as q,v as re,y as x}from"./chunk-M73AAOSC.js";import"./chunk-ZADLNAUM.js";import{a as Pe}from"./chunk-Y6WQRSAL.js";import{a as Ie}from"./chunk-BKN2BOUT.js";import{a as Me}from"./chunk-QWESRETT.js";import{a as Le}from"./chunk-HU6HZYEB.js";import{a as K}from"./chunk-SUV35JJV.js";import{a as Be}from"./chunk-F5WXPBTY.js";import"./chunk-DTPR5VRM.js";import{a as Qe}from"./chunk-G5SHUQL4.js";import{a as P}from"./chunk-K32J6RS5.js";import{a as z}from"./chunk-633OWGHO.js";import"./chunk-W42R6TEG.js";import{a as Te}from"./chunk-4JAOIN2Q.js";import"./chunk-NRF5E4NM.js";import"./chunk-EERRLM6T.js";import{a as qe}from"./chunk-AMBECJSA.js";import{a as V}from"./chunk-SVOLGRZA.js";import"./chunk-AMLNDKL6.js";import{a as G}from"./chunk-G3X3JRPI.js";import{a as W}from"./chunk-TJ6L7XVK.js";import{a as F}from"./chunk-W5YL3QSG.js";import"./chunk-LGGDA375.js";import{a as oe}from"./chunk-YLV5UIKA.js";import"./chunk-SRR4B7GE.js";import"./chunk-RZ3TV2NA.js";import"./chunk-MXS7SZ5M.js";import"./chunk-BRIPXERW.js";import{a as Se}from"./chunk-A5UFVDS4.js";import"./chunk-W4SU7VMV.js";import"./chunk-TBHB36S6.js";import{a as xe}from"./chunk-L35RWJ6D.js";import{a as M}from"./chunk-3XARJZUK.js";import"./chunk-RC6Y3VA2.js";import"./chunk-ILE2VADS.js";import{a as je}from"./chunk-DOJ57NAO.js";import"./chunk-KZTI7NFS.js";import"./chunk-L2KXS2FW.js";import"./chunk-GWVOQB64.js";import{a as Ee}from"./chunk-VMJOI624.js";import"./chunk-A2JPUMZD.js";import{b as Ae,i as we}from"./chunk-I67LU25W.js";import"./chunk-PH4INCXG.js";var L=We(new Map),ze=Fe(L,t=>[...t].reduce((e,[,o])=>e+(o.get("del")?.length??0),0));function st(t){let e;return{c(){e=g("tr"),e.innerHTML='<td class="compDel svelte-1qoer4b" colspan="3">Deleted</td>'},m(o,n){y(o,e,n)},p:A,i:A,o:A,d(o){o&&D(e)}}}function mt(t){let e,o,n,r,l,a,c,$=t[0].get("del").length+"",m,s,p,k,S,f,d=[ft,pt],_=[];function w(i,j){return(p==null||j&1)&&(p=!!i[0].get("delPending")),p?0:1}return k=w(t,-1),S=_[k]=d[k](t),{c(){e=g("tr"),o=g("td"),n=g("img"),a=q(),c=g("td"),m=E($),s=q(),S.c(),me(n.src,r=t[1](t[0]))||x(n,"src",r),x(n,"class","tip-dynamic"),x(n,"data-tipped",l=t[2](t[0])),x(n,"alt","component")},m(i,j){y(i,e,j),u(e,o),u(o,n),u(e,a),u(e,c),u(c,m),u(e,s),_[k].m(e,null),f=!0},p(i,j){(!f||j&1&&!me(n.src,r=i[1](i[0])))&&x(n,"src",r),(!f||j&1&&l!==(l=i[2](i[0])))&&x(n,"data-tipped",l),(!f||j&1)&&$!==($=i[0].get("del").length+"")&&le(m,$);let b=k;k=w(i,j),k===b?_[k].p(i,j):(N(),v(_[b],1,1,()=>{_[b]=null}),R(),S=_[k],S?S.p(i,j):(S=_[k]=d[k](i),S.c()),h(S,1),S.m(e,null))},i(i){f||(h(S),f=!0)},o(i){v(S),f=!1},d(i){i&&D(e),_[k].d()}}}function pt(t){let e,o,n;return o=new H({props:{$$slots:{default:[ut]},$$scope:{ctx:t}}}),o.$on("click",X(t[3])),{c(){e=g("td"),B(o.$$.fragment)},m(r,l){y(r,e,l),I(o,e,null),n=!0},p(r,l){let a={};l&256&&(a.$$scope={dirty:l,ctx:r}),o.$set(a)},i(r){n||(h(o.$$.fragment,r),n=!0)},o(r){v(o.$$.fragment,r),n=!1},d(r){r&&D(e),Q(o)}}}function ft(t){let e;return{c(){e=g("td"),e.innerHTML='<span class="fshSpinner fshSpinner12"></span>',x(e,"class","compSumSpin")},m(o,n){y(o,e,n)},p:A,i:A,o:A,d(o){o&&D(e)}}}function ut(t){let e;return{c(){e=E("Del")},m(o,n){y(o,e,n)},d(o){o&&D(e)}}}function dt(t){let e,o,n,r,l,a=[mt,st],c=[];function $(m,s){return(e==null||s&1)&&(e=!!m[0].get("del").length),e?0:1}return o=$(t,-1),n=c[o]=a[o](t),{c(){n.c(),r=re()},m(m,s){c[o].m(m,s),y(m,r,s),l=!0},p(m,[s]){let p=o;o=$(m,s),o===p?c[o].p(m,s):(N(),v(c[p],1,1,()=>{c[p]=null}),R(),n=c[o],n?n.p(m,s):(n=c[o]=a[o](m),n.c()),h(n,1),n.m(r.parentNode,r))},i(m){l||(h(n),l=!0)},o(m){v(n),l=!1},d(m){c[o].d(m),m&&D(r)}}}function _t(t,e,o){let n;ne(t,L,p=>o(5,n=p));let{itemId:r}=e,l=ce(),a=Qe(),c=p=>`${Ae}items/${p.get("b")}.gif`,$=p=>`fetchitem.php?item_id=${p.get("b")}&inv_id=${p.get("a")}&t=2&p=${a}&vcode=${p.get("v")}`,m;function s(){P("components","delType"),l("delType",r)}return t.$$set=p=>{"itemId"in p&&o(4,r=p.itemId)},t.$$.update=()=>{if(t.$$.dirty&48){e:o(0,m=n.get(r))}},[m,c,$,s,r,n]}var Ke=class extends Z{constructor(e){super();Y(this,e,_t,dt,O,{itemId:4})}},Oe=Ke;var bt=/\?item_id=(\d+)&inv_id=(\d+)&.*&vcode=([0-9a-f]+)/;function gt(t){let e=t.children[0].dataset.tipped.match(bt);return{a:Number(e[2]),b:Number(e[1]),v:e[3]}}var ht=t=>V('a[href*="=destroycomponent&"]',t).map(gt);async function pe(){let t=await F({cmd:"profile"}),e=W(t),o=V('a[href*="profile&component_page="]',e);return{r:(await G([t,...o.slice(1).map(l=>oe(l.href))])).map(W).flatMap(ht),s:!0}}function fe(){return K({subcmd:"loadcomponents"})}function ue(){return z(fe,pe)}function de(){return K({subcmd:"limits"})}var kt=t=>t[t.length-1].href,Xe=t=>V('td[background*="1x1mini"]',t).length;async function $t(t,e){if(e.length>1){let o=W(await oe(kt(e)));return(e.length-1)*50+Xe(o)}return Xe(t)}async function _e(){let t=W(await F({cmd:"profile"})),e=V('a[href*="=profile&component_page="]',t);return{r:{max_components:await $t(t,e)},s:!0}}function be(){return z(de,_e)}async function se(t){let e=await t();if(!e?.s)throw new Error(e?.e?.message??"Unknown Error");return e}function ge(t){return new Map(xe(t))}function Ye(t){t[4]=t[6][0],t[5]=t[6][1].r}function Ze(t,e,o){let n=t.slice();return n[7]=e[o],n}function vt(t){let e,o=t[10].message+"",n;return{c(){e=g("p"),n=E(o),ee(e,"color","red")},m(r,l){y(r,e,l),u(e,n)},p:A,i:A,o:A,d(r){r&&D(e)}}}function yt(t){Ye(t);let e,o,n,r,l,a,c,$,m,s,p,k,S,f=t[5].max_components+"",d,_,w=t[4],i=[];for(let b=0;b<w.length;b+=1)i[b]=Je(Ze(t,w,b));let j=b=>v(i[b],1,1,()=>{i[b]=null});return{c(){e=g("div"),o=g("table"),n=g("thead"),n.innerHTML='<tr><th colspan="3">Component Summary</th></tr>',r=q(),l=g("tbody");for(let b=0;b<i.length;b+=1)i[b].c();a=q(),c=g("tfoot"),$=g("tr"),m=g("td"),m.textContent="Total:",s=q(),p=g("td"),k=E(t[0]),S=E(" / "),d=E(f),x(p,"colspan","2"),x(o,"class","fshTblCenter")},m(b,T){y(b,e,T),u(e,o),u(o,n),u(o,r),u(o,l);for(let C=0;C<i.length;C+=1)i[C].m(l,null);u(o,a),u(o,c),u(c,$),u($,m),u($,s),u($,p),u(p,k),u(p,S),u(p,d),_=!0},p(b,T){if(Ye(b),T&2){w=b[4];let C;for(C=0;C<w.length;C+=1){let Ce=Ze(b,w,C);i[C]?(i[C].p(Ce,T),h(i[C],1)):(i[C]=Je(Ce),i[C].c(),h(i[C],1),i[C].m(l,null))}for(N(),C=w.length;C<i.length;C+=1)j(C);R()}(!_||T&1)&&le(k,b[0])},i(b){if(!_){for(let T=0;T<w.length;T+=1)h(i[T]);_=!0}},o(b){i=i.filter(Boolean);for(let T=0;T<i.length;T+=1)v(i[T]);_=!1},d(b){b&&D(e),Re(i,b)}}}function Je(t){let e,o;return e=new Oe({props:{itemId:t[7]}}),e.$on("delType",t[2]),{c(){B(e.$$.fragment)},m(n,r){I(e,n,r),o=!0},p:A,i(n){o||(h(e.$$.fragment,n),o=!0)},o(n){v(e.$$.fragment,n),o=!1},d(n){Q(e,n)}}}function Dt(t){let e;return{c(){e=g("div"),e.innerHTML='<span class="fshSpinner fshSpinner12"></span>',x(e,"class","compSumSpin")},m(o,n){y(o,e,n)},p:A,i:A,o:A,d(o){o&&D(e)}}}function Ct(t){let e,o,n,r={ctx:t,current:null,token:null,hasCatch:!0,pending:Dt,then:yt,catch:vt,value:6,error:10,blocks:[,,,]};return Ve(o=G([t[1](),se(be)]),r),{c(){e=re(),r.block.c()},m(l,a){y(l,e,a),r.block.m(l,r.anchor=a),r.mount=()=>e.parentNode,r.anchor=e,n=!0},p(l,[a]){t=l,He(r,t,a)},i(l){n||(h(r.block),n=!0)},o(l){for(let a=0;a<3;a+=1){let c=r.blocks[a];v(c)}n=!1},d(l){l&&D(e),r.block.d(l),r.token=null,r=null}}}function St(t,e,o){let n;ne(t,ze,c=>o(0,n=c));function r(c){let $=new Map(ae(c,"b").map(m=>[m.b,ge({...m,del:c.filter(({b:s})=>s===m.b).map(({a:s})=>s),delPending:!1})]));return L.set($),[...$.keys()]}async function l(){let c=await se(ue);return r(c.r)}function a(c){ie.call(this,t,c)}return[n,l,a]}var et=class extends Z{constructor(e){super();Y(this,e,St,Ct,O,{})}},tt=et;function ot(t){let e,o,n;return o=new H({props:{$$slots:{default:[At]},$$scope:{ctx:t}}}),o.$on("click",X(t[2])),{c(){e=g("div"),B(o.$$.fragment)},m(r,l){y(r,e,l),I(o,e,null),n=!0},p(r,l){let a={};l&256&&(a.$$scope={dirty:l,ctx:r}),o.$set(a)},i(r){n||(h(o.$$.fragment,r),n=!0)},o(r){v(o.$$.fragment,r),n=!1},d(r){r&&D(e),Q(o)}}}function At(t){let e;return{c(){e=E("Enable Quick Del")},m(o,n){y(o,e,n)},d(o){o&&D(e)}}}function wt(t){let e,o;return e=new tt({}),e.$on("delType",t[6]),{c(){B(e.$$.fragment)},m(n,r){I(e,n,r),o=!0},p:A,i(n){o||(h(e.$$.fragment,n),o=!0)},o(n){v(e.$$.fragment,n),o=!1},d(n){Q(e,n)}}}function xt(t){let e,o,n;return o=new H({props:{$$slots:{default:[Tt]},$$scope:{ctx:t}}}),o.$on("click",X(t[3])),{c(){e=g("div"),B(o.$$.fragment)},m(r,l){y(r,e,l),I(o,e,null),n=!0},p(r,l){let a={};l&256&&(a.$$scope={dirty:l,ctx:r}),o.$set(a)},i(r){n||(h(o.$$.fragment,r),n=!0)},o(r){v(o.$$.fragment,r),n=!1},d(r){r&&D(e),Q(o)}}}function Tt(t){let e;return{c(){e=E("Count Components")},m(o,n){y(o,e,n)},d(o){o&&D(e)}}}function Et(t){let e;return{c(){e=E("Quick Extract")},m(o,n){y(o,e,n)},d(o){o&&D(e)}}}function nt(t){let e,o,n,r;return o=new H({props:{$$slots:{default:[jt]},$$scope:{ctx:t}}}),o.$on("click",X(t[5])),{c(){e=g("div"),n=g("div"),B(o.$$.fragment),ee(n,"display","contents"),ee(n,"--button-color","red")},m(l,a){y(l,e,a),u(e,n),I(o,n,null),r=!0},p(l,a){let c={};a&256&&(c.$$scope={dirty:a,ctx:l}),o.$set(c)},i(l){r||(h(o.$$.fragment,l),r=!0)},o(l){v(o.$$.fragment,l),r=!1},d(l){l&&D(e),Q(o)}}}function jt(t){let e;return{c(){e=E("Delete All Visible")},m(o,n){y(o,e,n)},d(o){o&&D(e)}}}function qt(t){let e,o,n,r,l,a,c,$,m,s=!t[0]&&ot(t),p=[xt,wt],k=[];function S(d,_){return d[1]?1:0}n=S(t,-1),r=k[n]=p[n](t),c=new H({props:{$$slots:{default:[Et]},$$scope:{ctx:t}}}),c.$on("click",t[4]);let f=t[0]&&nt(t);return{c(){e=g("div"),s&&s.c(),o=q(),r.c(),l=q(),a=g("div"),B(c.$$.fragment),$=q(),f&&f.c(),x(e,"class","fshCenter")},m(d,_){y(d,e,_),s&&s.m(e,null),u(e,o),k[n].m(e,null),u(e,l),u(e,a),I(c,a,null),u(e,$),f&&f.m(e,null),m=!0},p(d,[_]){d[0]?s&&(N(),v(s,1,1,()=>{s=null}),R()):s?(s.p(d,_),_&1&&h(s,1)):(s=ot(d),s.c(),h(s,1),s.m(e,o));let w=n;n=S(d,_),n===w?k[n].p(d,_):(N(),v(k[w],1,1,()=>{k[w]=null}),R(),r=k[n],r?r.p(d,_):(r=k[n]=p[n](d),r.c()),h(r,1),r.m(e,l));let i={};_&256&&(i.$$scope={dirty:_,ctx:d}),c.$set(i),d[0]?f?(f.p(d,_),_&1&&h(f,1)):(f=nt(d),f.c(),h(f,1),f.m(e,null)):f&&(N(),v(f,1,1,()=>{f=null}),R())},i(d){m||(h(s),h(r),h(c.$$.fragment,d),h(f),m=!0)},o(d){v(s),v(r),v(c.$$.fragment,d),v(f),m=!1},d(d){d&&D(e),s&&s.d(),k[n].d(),Q(c),f&&f.d()}}}function Bt(t,e,o){let n,r,l=ce();function a(){P("components","enableQuickDel"),o(0,n=!0),l("enableQuickDel")}function c(){P("components","countComponents"),o(1,r=!0)}function $(){P("components","insertQuickExtract"),Le(Ie)}function m(){P("components","deleteAllVisible"),l("deleteAllVisible")}function s(p){ie.call(this,t,p)}return[n,r,a,c,$,m,s]}var rt=class extends Z{constructor(e){super();Y(this,e,Bt,qt,O,{})}},lt=rt;function he(t){return K({subcmd:"destroycomponent",removeIndex:t})}function It(t,e){let o=Be(e),n=1;return o==="Component destroyed."&&(n=0),{r:n,m:o,c:t}}function Qt(t){return F({cmd:"profile",subcmd:"destroycomponent",component_id:t}).then(M(It,t))}function Lt(t){let e=t.filter(n=>n.r===0),o=t.filter(n=>n.r===1);return e.length>0?{r:e.map(n=>n.c),s:!0}:o.length>0?{e:{message:o[0].m},s:!1}:{e:{message:t[0].m},s:!1}}function ke(t){return Pe(t.map(Qt),Lt)}function $e(t){return z(he,ke,t)}function Mt(t,e){if(!e)return;let o=e.get("del").filter(n=>!t.includes(n));e.set("del",o)}function Pt(t,e){L.update(o=>(Mt(e,o.get(t)),o))}function Nt(t,e,o){L.update(n=>(n.get(t)?.set(e,o),n))}function Rt(t){if(!t)return;let e=t.children[0];return e.replaceWith(Te({className:"compSumSpin",innerHTML:'<span class="fshSpinner fshSpinner12"></span>'})),e}function ct(t,e){Nt(e,"delPending",t)}function Vt(t){t.forEach(([e,o])=>{o&&e.children[0].replaceWith(o)})}var Ht=t=>t.forEach(([e])=>e?.children[0]?.remove()),Ut=t=>t.map(([e])=>[e,Rt(e)]),Wt=([,t])=>t,it=t=>ae(t.map(Wt)),at=([,,t])=>t,Ft=t=>it(t).map(e=>[e,t.filter(([,o])=>o===e).map(at)]),Gt=t=>Pt(...t);async function zt(t){let e=Ut(t),o=await $e(t.map(at));o?.s?(Ft(t).forEach(Gt),Ht(e)):(Ge(o?.e?.message??"Unknown Error"),Vt(e))}async function U(t){let e=it(t);e.forEach(M(ct,!0)),await G(Ue(30,t).map(zt)),e.forEach(M(ct,!1))}var Kt=t=>Ne(L).get(t.detail).get("del"),Ot=(t,e)=>J(qe(`img[data-tipped*="&inv_id=${e}&"]`,t));async function ve(t,e){U(Kt(e).map(o=>[Ot(t,o),e.detail,o]))}function te(t){let e=t.dataset.tipped.match(we);return[Number(e[1]),Number(e[2])]}var Xt=t=>[J(t),...te(t)];function ye(t){U(V("img",t).map(Xt))}function Yt(t){t.target.tagName==="IMG"&&(t.preventDefault(),P("components","quickDel"),Me(t.target),U([[J(t.target),...te(t.target)]]))}function De(t){t.classList.add("fshQuickDel"),je(t,Yt)}function Zt(){let t=Se("profileRightColumn"),e=Ee("inventory-table",t);if(e.length===2)return e[1]}function Jt(){let t=Zt();if(!t)return;let e=new lt({target:t.parentNode});e.$on("enableQuickDel",M(De,t)),e.$on("delType",M(ve,t)),e.$on("deleteAllVisible",M(ye,t))}export{Jt as default};
//# sourceMappingURL=components-WSJSY467.js.map
